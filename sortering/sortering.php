<div class="group85">
 <div class="viser-resultater">Viser 1-12 av 15 resultater</div>

 <div class="vector">
 <div data-svg-wrapper data-layer="Vector" class="Vector">
 <svg width="29" height="20" viewBox="0 0 29 20" fill="none" xmlns="http://www.w3.org/2000/svg">
 <path d="M2 2.08337H27M6.80833 10H22.1917M11.6167 17.9167H17.3833" stroke="black" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
 </svg>
 </div>
 </div>

 <div class="filter">FILTER</div>

 <!-- Ny wrapper -->
 <div class="visning-wrapper" id="bd-shop-view" data-default="grid">
 <div class="velg-visning">Velg visning:</div> 
 <div class="filterIcon" data-view="grid">
	<div data-svg-wrapper data-layer="Icon" class="Icon">
 <svg width="18" height="16" viewBox="0 0 18 16" fill="none" xmlns="http://www.w3.org/2000/svg" >
 <path d="M3.93775 0.00860333C4.13112 0.0598284 4.29728 0.16807 4.40698 0.314284C4.51667 0.460498 4.56295 0.635303 4.53752 0.807926C4.53752 1.59866 4.53752 2.38079 4.53752 3.16293C4.55 3.25847 4.53742 3.35521 4.5008 3.44605C4.46417 3.53689 4.40442 3.61955 4.32584 3.68794C4.24727 3.75634 4.15188 3.80874 4.0467 3.84133C3.94152 3.87393 3.82915 3.8859 3.71791 3.87632C2.79842 3.87632 1.88893 3.87632 0.979436 3.87632C0.778147 3.90182 0.572966 3.86358 0.401998 3.76873C0.231031 3.67387 0.105981 3.52887 0.050021 3.36065V0.515727C0.0895677 0.393896 0.164302 0.282663 0.26743 0.192473C0.370557 0.102283 0.498674 0.0360516 0.639659 0L3.93775 0.00860333Z" fill="#223C52"/>
 <path d="M10.684 0.00860333C10.8774 0.0598284 11.0435 0.16807 11.1532 0.314284C11.2629 0.460498 11.3092 0.635303 11.2838 0.807926C11.2838 1.59866 11.2838 2.38079 11.2838 3.16293C11.2962 3.25847 11.2837 3.35521 11.247 3.44605C11.2104 3.53689 11.1507 3.61955 11.0721 3.68794C10.9935 3.75634 10.8981 3.80874 10.7929 3.84133C10.6878 3.87393 10.5754 3.8859 10.4641 3.87632H7.61576C7.50451 3.8859 7.39214 3.87393 7.28696 3.84133C7.18178 3.80874 7.08639 3.75634 7.00782 3.68794C6.92924 3.61955 6.86949 3.53689 6.83286 3.44605C6.79624 3.35521 6.78378 3.25847 6.79626 3.16293C6.79626 2.38079 6.79626 1.59866 6.79626 0.807926C6.77083 0.635303 6.81699 0.460498 6.92668 0.314284C7.03638 0.16807 7.20254 0.0598284 7.39591 0.00860333H10.684Z" fill="#223C52"/>
 <path d="M17.99 3.38641C17.9302 3.55433 17.8027 3.69847 17.6306 3.79297C17.4584 3.88746 17.2529 3.92617 17.0506 3.90213C16.1411 3.90213 15.2315 3.90213 14.312 3.90213C14.2007 3.91171 14.0885 3.89974 13.9833 3.86714C13.8781 3.83455 13.7827 3.78215 13.7042 3.71375C13.6256 3.64536 13.5658 3.5627 13.5292 3.47186C13.4926 3.38102 13.48 3.28428 13.4925 3.18874C13.4925 2.4066 13.4925 1.62447 13.4925 0.833736C13.4671 0.661113 13.5132 0.486308 13.6229 0.340094C13.7326 0.19388 13.8988 0.0856384 14.0921 0.0344133H17.4004C17.5419 0.07134 17.6707 0.137721 17.7753 0.227673C17.8799 0.317626 17.9571 0.428353 18 0.550088L17.99 3.38641Z" fill="#223C52"/>
 <path d="M0 6.34305C0.05576 6.17649 0.179377 6.03274 0.348195 5.93806C0.517014 5.84338 0.71981 5.8041 0.919533 5.82737C1.83902 5.82737 2.74851 5.82737 3.658 5.82737C3.76963 5.81804 3.8822 5.83008 3.98777 5.86263C4.09335 5.89517 4.18932 5.94739 4.26862 6.0156C4.34793 6.0838 4.40865 6.16627 4.4465 6.25707C4.48435 6.34786 4.49835 6.44472 4.4875 6.54071C4.4875 7.35437 4.4875 8.17092 4.4875 8.9903C4.49838 9.08517 4.4847 9.18094 4.44736 9.2707C4.41002 9.36046 4.34994 9.44198 4.27155 9.50939C4.19317 9.5768 4.09837 9.62841 3.994 9.66052C3.88962 9.69263 3.77833 9.70445 3.66801 9.69509C2.74852 9.69509 1.83903 9.69509 0.929537 9.69509C0.728248 9.72059 0.522945 9.68235 0.351977 9.5875C0.18101 9.49264 0.0559601 9.34759 0 9.17937V6.34305Z" fill="#223C52"/>
 <path d="M17.99 9.18798C17.9304 9.35427 17.8045 9.49716 17.6345 9.59149C17.4644 9.68583 17.2612 9.72558 17.0604 9.7037C16.1409 9.7037 15.2314 9.7037 14.312 9.7037C14.2016 9.71306 14.0903 9.70124 13.986 9.66913C13.8816 9.63702 13.7868 9.58541 13.7084 9.518C13.63 9.45059 13.5699 9.36907 13.5326 9.27931C13.4953 9.18955 13.4816 9.09379 13.4925 8.99891C13.4925 8.17953 13.4925 7.36298 13.4925 6.54933C13.4816 6.45333 13.4956 6.35647 13.5335 6.26568C13.5713 6.17489 13.632 6.09241 13.7113 6.02421C13.7906 5.95601 13.8866 5.90373 13.9922 5.87119C14.0978 5.83864 14.2103 5.82665 14.322 5.83599C15.2315 5.83599 16.1409 5.83599 17.0604 5.83599C17.2612 5.81411 17.4644 5.85381 17.6345 5.94814C17.8045 6.04247 17.9304 6.18537 17.99 6.35166V9.18798Z" fill="#223C52"/>
 <path d="M0 12.1446C0.05576 11.9781 0.179377 11.8343 0.348195 11.7396C0.517014 11.645 0.71981 11.6057 0.919533 11.629C1.83902 11.629 2.74851 11.629 3.658 11.629C3.76963 11.6196 3.8822 11.6317 3.98777 11.6642C4.09335 11.6968 4.18932 11.749 4.26862 11.8172C4.34793 11.8854 4.40865 11.9679 4.4465 12.0586C4.48435 12.1494 4.49835 12.2463 4.4875 12.3423C4.4875 13.1559 4.4875 13.9725 4.4875 14.7919C4.49838 14.8868 4.4847 14.9825 4.44736 15.0723C4.41002 15.162 4.34994 15.2436 4.27155 15.311C4.19317 15.3784 4.09837 15.43 3.994 15.4621C3.88962 15.4942 3.77833 15.506 3.66801 15.4967C2.74852 15.4967 1.83903 15.4967 0.929537 15.4967C0.728248 15.5222 0.522945 15.4839 0.351977 15.3891C0.18101 15.2942 0.0559601 15.1492 0 14.9809V12.1446Z" fill="#223C52"/>
 <path d="M17.99 14.9896C17.9304 15.1558 17.8045 15.2987 17.6345 15.3931C17.4644 15.4874 17.2612 15.5272 17.0604 15.5053C16.1409 15.5053 15.2314 15.5053 14.312 15.5053C14.2016 15.5146 14.0903 15.5028 13.986 15.4707C13.8816 15.4386 13.7868 15.387 13.7084 15.3196C13.63 15.2522 13.5699 15.1707 13.5326 15.0809C13.4953 14.9911 13.4816 14.8954 13.4925 14.8005C13.4925 13.9811 13.4925 13.1646 13.4925 12.3509C13.4816 12.2549 13.4956 12.1581 13.5335 12.0673C13.5713 11.9765 13.632 11.894 13.7113 11.8258C13.7906 11.7576 13.8866 11.7053 13.9922 11.6728C14.0978 11.6402 14.2103 11.6282 14.322 11.6376C15.2315 11.6376 16.1409 11.6376 17.0604 11.6376C17.2612 11.6157 17.4644 11.6554 17.6345 11.7497C17.8045 11.8441 17.9304 11.9869 17.99 12.1532V14.9896Z" fill="#223C52"/>
 <path d="M11.2838 7.74404C11.2838 8.15659 11.2838 8.60353 11.2838 8.98171C11.2912 9.07365 11.2756 9.16588 11.2381 9.25219C11.2005 9.3385 11.1418 9.41685 11.0661 9.48202C10.9903 9.54718 10.8991 9.59765 10.7987 9.62995C10.6984 9.66225 10.5911 9.67566 10.4842 9.6693H7.58581C7.47931 9.67582 7.37242 9.66243 7.2725 9.63006C7.17259 9.59769 7.08205 9.54714 7.00703 9.4818C6.932 9.41647 6.87431 9.33794 6.83793 9.25161C6.80155 9.16529 6.7874 9.07321 6.79633 8.98171C6.79633 8.12222 6.79633 7.33147 6.79633 6.49776C6.78723 6.40436 6.80193 6.31037 6.83939 6.22235C6.87686 6.13433 6.93618 6.0544 7.01325 5.98812C7.09032 5.92184 7.18321 5.87083 7.28556 5.83861C7.38791 5.80639 7.4972 5.79375 7.60581 5.80157H10.4842C10.5929 5.79489 10.7021 5.80872 10.804 5.84202C10.9059 5.87532 10.9981 5.92732 11.0742 5.99441C11.1503 6.06151 11.2085 6.14206 11.2447 6.23048C11.2809 6.3189 11.2943 6.41306 11.2838 6.50637C11.2838 6.94471 11.2838 7.35727 11.2838 7.74404Z" fill="#223C52"/>
 <path d="M6.78632 13.5543C6.78632 13.1417 6.78632 12.6947 6.78632 12.308C6.78054 12.2175 6.797 12.127 6.83463 12.0424C6.87227 11.9577 6.9302 11.8809 7.0047 11.8168C7.07921 11.7527 7.1686 11.7029 7.26701 11.6705C7.36542 11.6382 7.47059 11.624 7.5758 11.629H10.4942C10.5986 11.6253 10.7027 11.6404 10.8 11.6733C10.8972 11.7062 10.9853 11.7562 11.0587 11.8202C11.1321 11.8841 11.1892 11.9605 11.2262 12.0445C11.2633 12.1285 11.2795 12.2183 11.2738 12.308C11.2738 13.1675 11.2738 14.027 11.2738 14.8263C11.2812 14.916 11.2661 15.006 11.2295 15.0902C11.193 15.1744 11.1358 15.251 11.0619 15.3145C10.988 15.3781 10.899 15.4272 10.8011 15.4587C10.7031 15.4901 10.5985 15.5031 10.4942 15.4967H7.55591C7.45372 15.5004 7.35168 15.4857 7.25639 15.4538C7.16111 15.4218 7.07459 15.3732 7.00226 15.311C6.92994 15.2488 6.87339 15.1744 6.83622 15.0924C6.79904 15.0105 6.78208 14.9228 6.78632 14.8349C6.77632 14.4051 6.78632 13.9754 6.78632 13.5543Z" fill="#223C52"/>
 </svg>
</div>
 </div> 
 <div class="filterIcon" data-view="list">
 	<div data-svg-wrapper data-layer="icon" class="Icon">
 			<svg width="18" height="16" viewBox="0 0 18 16" fill="none" xmlns="http://www.w3.org/2000/svg" >
 			<path d="M11.9793 2.48491H6.66166C6.21053 2.48491 5.98011 2.28618 6.00891 1.93009C6.00871 1.81128 6.06141 1.69694 6.15607 1.61065C6.25073 1.52436 6.38015 1.47271 6.51766 1.46634H17.2009C17.2934 1.45791 17.3868 1.45791 17.4793 1.46634C17.6219 1.47482 17.7552 1.53026 17.8517 1.62121C17.9481 1.71216 18.0005 1.83163 17.9977 1.9549C18.0015 2.08051 17.9519 2.20301 17.8581 2.29916C17.7643 2.39531 17.633 2.45843 17.4889 2.47662C17.3835 2.4849 17.2774 2.4849 17.1721 2.47662L11.9793 2.48491Z" fill="#253B7A"/>
 			<path d="M11.9794 8.39768H6.69054C6.21061 8.39768 5.97057 8.19064 6.00896 7.81799C6.01511 7.70747 6.06694 7.60249 6.15495 7.522C6.24297 7.44152 6.36136 7.39079 6.48889 7.37907H17.4217C17.4969 7.37797 17.5716 7.38983 17.6414 7.41389C17.7112 7.43795 17.7748 7.47374 17.8284 7.51922C17.882 7.5647 17.9246 7.61897 17.9536 7.67879C17.9827 7.73862 17.9977 7.80281 17.9977 7.86768C18.0006 8.00277 17.9436 8.13372 17.8384 8.23377C17.7331 8.33382 17.5874 8.39544 17.4313 8.40597H11.9794V8.39768Z" fill="#253B7A"/>
 			<path d="M12.0081 13.2504H17.3258C17.8345 13.2504 18.1225 13.5734 17.9497 13.946C17.9175 14.0342 17.8555 14.112 17.7717 14.1696C17.6879 14.2271 17.5861 14.2617 17.4794 14.269H6.85367C6.74191 14.2774 6.62952 14.2774 6.51775 14.269C6.37941 14.2647 6.24862 14.2136 6.15346 14.1269C6.05831 14.0402 6.00639 13.9246 6.00899 13.8052C5.99671 13.7432 5.99904 13.6796 6.01567 13.6183C6.0323 13.5569 6.06296 13.4991 6.10589 13.4482C6.14883 13.3973 6.2031 13.3543 6.2656 13.3217C6.32809 13.2892 6.39758 13.2677 6.46982 13.2587C6.58161 13.2506 6.69397 13.2506 6.80575 13.2587L12.0081 13.2504Z" fill="#253B7A"/>
 			<path d="M0.000370401 12.7784C-0.00347406 12.6491 0.0226373 12.5204 0.0773513 12.4C0.132065 12.2795 0.21417 12.1698 0.318839 12.0772C0.423508 11.9846 0.548707 11.9109 0.686871 11.8607C0.825035 11.8105 0.973397 11.7846 1.12333 11.7846C1.79523 11.7846 2.45761 11.7846 3.11991 11.7846C3.27072 11.7846 3.41997 11.8104 3.55918 11.8604C3.69839 11.9105 3.82477 11.9838 3.93096 12.0762C4.03716 12.1686 4.12112 12.2782 4.17796 12.3987C4.23479 12.5193 4.26335 12.6483 4.26209 12.7784C4.26209 13.3912 4.26209 14.004 4.26209 14.6168C4.25493 14.8507 4.14475 15.0733 3.95393 15.2395C3.76311 15.4056 3.50605 15.5028 3.23509 15.5111C2.52479 15.5111 1.8048 15.5111 1.09451 15.5111C0.796613 15.5004 0.515445 15.3895 0.310989 15.2023C0.106532 15.0151 -0.00490194 14.7664 0.000370401 14.5092V12.7784ZM3.1007 12.7784H1.18098V14.4346H3.1007V12.7784Z" fill="#253B7A"/>
 			<path d="M0.0579013 1.76446V0.936348C0.0527018 0.814352 0.076298 0.69272 0.127149 0.578798C0.178 0.464876 0.255056 0.361037 0.353756 0.273562C0.452456 0.186086 0.570653 0.116789 0.701283 0.0698688C0.831913 0.0229486 0.972231 -0.000629683 1.11372 0.000572742H3.1007C3.24931 -0.00385524 3.39742 0.0174271 3.53634 0.063197C3.67525 0.108967 3.80216 0.178276 3.90952 0.267042C4.01688 0.355807 4.10253 0.462267 4.16144 0.580062C4.22035 0.697856 4.25129 0.824639 4.25248 0.952926C4.25248 1.58229 4.25248 2.21164 4.25248 2.841C4.24006 3.07898 4.12108 3.3035 3.92054 3.46725C3.71999 3.631 3.45355 3.72119 3.17744 3.7188C2.51514 3.7188 1.85288 3.7188 1.18098 3.7188C1.03024 3.71996 0.880757 3.6949 0.741473 3.64516C0.602188 3.59542 0.475971 3.52202 0.370277 3.42929C0.264584 3.33655 0.181517 3.22644 0.126212 3.10545C0.0709056 2.98446 0.0444221 2.85507 0.0482933 2.72506C0.0482933 2.41865 0.0482933 2.11226 0.0482933 1.80586L0.0579013 1.76446ZM3.09109 2.69195V0.977743H1.17137C1.17137 1.53258 1.17137 2.05428 1.17137 2.56771C1.17137 2.56771 1.24816 2.68366 1.29616 2.68366L3.09109 2.69195Z" fill="#253B7A"/>
 			<path d="M2.22717 9.57356C1.89122 9.57356 1.54562 9.57356 1.20967 9.57356C0.916812 9.56925 0.637514 9.46638 0.431304 9.28692C0.225093 9.10747 0.108383 8.86565 0.105922 8.61297C0.105922 8.025 0.105922 7.44529 0.105922 6.8656C0.110779 6.61576 0.227283 6.3772 0.431187 6.19974C0.63509 6.02227 0.910639 5.91967 1.20018 5.9133H3.18703C3.47815 5.91108 3.7585 6.00815 3.96703 6.18341C4.17557 6.35867 4.29545 6.59794 4.3005 6.84908C4.3005 7.43704 4.3005 8.03324 4.3005 8.62121C4.28829 8.87468 4.16415 9.11456 3.95356 9.29162C3.74297 9.46869 3.46183 9.56955 3.16782 9.57356C2.83187 9.57356 2.49591 9.57356 2.20796 9.57356H2.22717ZM1.26731 8.55499H3.18703V6.89876H1.26731V8.55499Z" fill="#253B7A"/>
 </svg>
</div>
 </div>
 </div>

 <div class="frame37">
 <div class="frame35">
 <span class="standard-sortering">Standard sortering</span>
 <div class="vector-arrow">
		 <div data-svg-wrapper data-layer="Vector" class="Vector">
 <svg width="11" height="8" viewBox="0 0 11 8" fill="none" xmlns="http://www.w3.org/2000/svg">
 <path d="M1.3925 0H9.60639C9.87772 0 10.0945 0.0873148 10.2567 0.261944C10.4189 0.435857 10.5 0.639113 10.5 0.871713C10.5 0.944713 10.4897 1.02093 10.469 1.10038C10.4491 1.1791 10.4185 1.25461 10.3772 1.32689L6.24873 7.59957C6.15288 7.73269 6.04302 7.83289 5.91916 7.90016C5.79603 7.96672 5.65631 8 5.5 8C5.34369 8 5.20397 7.96672 5.08085 7.90016C4.95772 7.8336 4.84786 7.73341 4.75127 7.59957L0.622761 1.32689C0.58221 1.25461 0.551611 1.17839 0.530967 1.09823C0.510323 1.01807 0.5 0.941851 0.5 0.869566C0.5 0.63625 0.581102 0.432993 0.743309 0.259796C0.905515 0.0865983 1.12191 0 1.3925 0Z" fill="#979797"/>
 </svg>
 </div>
 </div> 
 </div>
 </div>
</div>
 


<script>
(function () {
 const STORAGE_KEY = 'bd-shop-view';
 const body = document.body;
 const wrap = document.getElementById('bd-shop-view'); if (!wrap) return;
 
 const icons = wrap.querySelectorAll('.filterIcon');
 icons.forEach(icon => {
 icon.addEventListener('click', () => {
 const v = icon.getAttribute('data-view');
 setView(v);
 localStorage.setItem(STORAGE_KEY, v);
 fixListButtons();
 });
 });
 
 const arrow = document.querySelector('.vector-arrow');
 arrow.addEventListener('click', e => {
 arrow.classList.toggle('is-open');
 });
 
 // Init – les lagret valg eller default
 const saved = localStorage.getItem(STORAGE_KEY);
 const initial = saved || wrap.getAttribute('data-default') || 'grid';
 setView(initial);
 fixListButtons();

 // Klikk

 


 // Re-run hvis produktlisten oppdateres dynamisk
 const productsRoot = document.querySelector('ul.products');
 if (productsRoot) {
 const mo = new MutationObserver(() => fixListButtons());
 mo.observe(productsRoot, {childList: true, subtree: true});
 }

 function setView(view) {
 body.classList.remove('bd-grid-view', 'bd-list-view');
 body.classList.add(view === 'list' ? 'bd-list-view' : 'bd-grid-view');
 icons.forEach(icon => {
 const active = icon.getAttribute('data-view') === view;
 icon.classList.toggle('is-active', active);
 icon.setAttribute('aria-pressed', active ? 'true' : 'false');
 });
 }

 // Velg én hovedknapp pr. produkt, skjul resten og plasser riktig
 function fixListButtons() {
 if (!body.classList.contains('bd-list-view')) return;
 document.querySelectorAll('ul.products > li.product').forEach(li => {
 const bdeBtn = li.querySelector('.bde-woo-product-footer .button'); // Breakdance-knappen
 const wooDir = li.querySelector(':scope > a.button, :scope > .button, :scope > a.add_to_cart_button, :scope > a.ajax_add_to_cart, :scope > a[class*="product_type_"]'); // Woo direkte barn
 const wooInLn = li.querySelector('.woocommerce-LoopProduct-link .button'); // Woo inni lenka

 // Prioritet: Breakdance → Woo direkte → Woo i lenka
 const chosen = bdeBtn || wooDir || wooInLn;

 [bdeBtn, wooDir, wooInLn].forEach(el => {
 if (!el) return;
 if (el !== chosen) el.classList.add('bd-hide'); else el.classList.remove('bd-hide');
 });

 if (chosen) { b
 const footer = chosen.closest('.bde-woo-product-footer');
 if (footer) {
 footer.classList.add('bd-primary-footer');
 chosen.classList.add('bd-primary-btn');
 } else {
 chosen.classList.add('bd-primary-btn', 'bd-primary-btn--self');
 }
 }
 });
 }
})();
</script>
 
<script>
(function(){
 // --- Konfig ---
 const LS_KEY = 'bd-sort'; // lagret valg
 const WRAP = document.querySelector('.frame37');
 const SORT_LABEL = WRAP && WRAP.querySelector('.standard-sortering');
 const SORT_TOGGLE = WRAP && WRAP.querySelector('.frame35'); // Klikk på hele knappen
 const ARROW = WRAP && WRAP.querySelector('.vector-arrow');
 const PRODUCTS = () => document.querySelector('ul.products');

 if (!WRAP || !SORT_TOGGLE || !SORT_LABEL) return;

 let menu = null;
 let isOpen = false;
 let outsideHandlerBound = false;

 // --- Bygg meny (én gang) ---
 function buildMenu(){
 if (menu) return menu;

 menu = document.createElement('ul');
 menu.className = 'bdpf-subcategory-list bdpf-attr-list'; // gjenbruker styling
 menu.style.display = 'none';
 menu.style.position = 'fixed';
 menu.style.zIndex = '99999';
 menu.style.background = '#fff';
 menu.style.border = '1px solid #e5e7eb';
 menu.style.borderRadius = '6px';
 menu.style.boxShadow = '0 4px 12px rgba(0,0,0,.12)';
 menu.style.padding = '6px 0';
 menu.style.maxHeight = '70vh';
 menu.style.overflow = 'auto';

 // helper: ett valg (sentraliser tekst)
 const mkItem = (value, text) => {
 const li = document.createElement('li');
 li.className = 'bdpf-subcat-item';
 // sentrer innholdet horisontalt
 li.style.display = 'flex';
 li.style.alignItems = 'center';
 li.style.justifyContent = 'center';
 li.style.padding = '8px 12px';

 li.innerHTML = `
 <label class="category-checkbox" data-sort="${value}" style="width:100%; text-align:center; cursor:pointer;">
 <span class="txt Underkategori" style="display:inline-block;">${text}</span>
 </label>`;
 return li;
 };

 // helper: separator (50% bredde, sentrert)
 const mkSep = () => {
 const sepWrap = document.createElement('li');
 // bruk <li> for å holde seg innenfor UL, men uten klikk
 sepWrap.setAttribute('aria-hidden','true');
 sepWrap.style.listStyle = 'none';
 sepWrap.style.pointerEvents = 'none';
 sepWrap.style.padding = '0';
 sepWrap.style.margin = '0';

 const sep = document.createElement('div');
 sep.style.width = '50%';
 sep.style.height = '1px';
 sep.style.margin = '0 auto'; // sentrer horisontalt
 sep.style.background = '#e5e7eb'; // nøytral grå (matcher resten)
 sepWrap.appendChild(sep);
 return sepWrap;
 };

 const items = [
 ['default', 'Standard sortering'],
 ['price-asc', 'Pris: Lav → Høy'],
 ['price-desc', 'Pris: Høy → Lav'],
 ['name-asc', 'Navn: A → Å'],
 ['name-desc', 'Navn: Å → A']
 ];

 // bygg liste med separator mellom hvert li (ikke før første / ikke etter siste)
 items.forEach((pair, idx) => {
 const [val, txt] = pair;
 const li = mkItem(val, txt);
 menu.appendChild(li);
 if (idx < items.length - 1) {
 menu.appendChild(mkSep());
 }
 });

 // Klikk på et valg
 menu.addEventListener('click', (e) => {
 const lab = e.target.closest('.category-checkbox');
 if (!lab) return;
 const value = lab.getAttribute('data-sort');
 setActive(value);
 localStorage.setItem(LS_KEY, value);
 applySort(value);
 try {
 const orderbyMap = {
 'default': '',
 'price-asc': 'price',
 'price-desc': 'price-desc',
 'name-asc': 'title',
 'name-desc': 'title-desc',
 'sku': 'sku'
 };
 document.dispatchEvent(new CustomEvent('bdpf:sort-changed', { detail: { orderby: orderbyMap[value] || '' } }));
 } catch(e) {}
 closeMenu();
 });

 document.body.appendChild(menu);
 return menu;
 }

 // Marker valgt (bold tekst – ingen bokser)
 function markChecked(value){
 if (!menu) return;
 menu.querySelectorAll('.category-checkbox').forEach(l => {
 const isOn = l.getAttribute('data-sort') === value;
 const txt = l.querySelector('.txt');
 if (txt) txt.style.fontWeight = isOn ? '600' : '400';
 });
 }

 function setActive(value){
 const map = {
 'default': 'Standard sortering',
 'price-asc': 'Pris: Lav → Høy',
 'price-desc': 'Pris: Høy → Lav',
 'name-asc': 'Navn: A → Å',
 'name-desc': 'Navn: Å → A'
 };
 SORT_LABEL.textContent = map[value] || map['default'];
 markChecked(value);
 }

 // Posisjoner menyen OVER knappen
 function positionMenuUp(){
 const rect = SORT_TOGGLE.getBoundingClientRect();
 const mt = 6; // margin
 const width = rect.width;

 // Mål ønsket høyde
 menu.style.display = 'block';
 menu.style.visibility= 'hidden';
 menu.style.minWidth = width + 'px';

 // X-pos
 const vw = Math.max(document.documentElement.clientWidth, window.innerWidth || 0);
 const left = Math.min(Math.max(8, rect.left), vw - menu.offsetWidth - 8);
 menu.style.left = left + 'px';

 // Y-pos (opp fra knappen)
 const desiredTop = rect.top - menu.offsetHeight - mt;
 const top = Math.max(8, desiredTop);
 menu.style.top = top + 'px';

 // Synlig
 menu.style.visibility = '';
 }

 function openMenu(){
 buildMenu();
 if (!menu) return;
 isOpen = true;
 menu.style.display = 'block';
 positionMenuUp();
 ARROW && ARROW.classList.add('is-open');

 if (!outsideHandlerBound){
 document.addEventListener('click', handleOutside, true);
 outsideHandlerBound = true;
 }
 }
 function closeMenu(){
 if (!menu) return;
 isOpen = false;
 menu.style.display = 'none';
 ARROW && ARROW.classList.remove('is-open');
 }
 function handleOutside(e){
 if (e.target.closest('.frame37') || (menu && e.target.closest('.bdpf-attr-list'))) return;
 closeMenu();
 }

 // --- Sorteringslogikk (DOM) ---
 function getPrice(li){
 const data = li.getAttribute('data-price') || li.dataset?.price;
 if (data) {
 const n = parseFloat(String(data).replace(',', '.'));
 if (isFinite(n)) return n;
 }
 const priceEl = li.querySelector('.price');
 if (!priceEl) return NaN;
 const ins = priceEl.querySelector('ins .amount, ins bdi, ins');
 const base = (ins || priceEl.querySelector('.amount, bdi, span'))?.textContent || '';
 const m = base.replace(/\s/g,'').match(/(\d+[.,]?\d*)/g);
 if (!m || !m.length) return NaN;
 const last = m[m.length-1].replace(/\./g, '').replace(',', '.');
 const num = parseFloat(last);
 return isFinite(num) ? num : NaN;
 }
 function getName(li){
 const t = li.querySelector('.woocommerce-loop-product__title');
 return (t ? t.textContent : li.textContent || '').trim();
 }
 function applySort(mode){
 // Når katalogen lastes via BDPF/AJAX må sortering gjøres server-side, ellers blir paginering feil på tvers av sider.
 if (document.querySelector('#bdpf-loop')) return;
 const root = PRODUCTS();
 if (!root) return;

 const items = Array.from(root.querySelectorAll(':scope > li.product'));
 if (items.length < 2) return;

 const decorated = items.map((el, idx) => ({
 el, idx,
 price: getPrice(el),
 name: getName(el).toLocaleLowerCase()
 }));
 const collator = new Intl.Collator('nb', {sensitivity:'base', numeric:true});

 decorated.sort((a,b) => {
 switch (mode){
 case 'price-asc': return (a.price - b.price) || (a.idx - b.idx);
 case 'price-desc': return (b.price - a.price) || (a.idx - b.idx);
 case 'name-asc': return collator.compare(a.name, b.name) || (a.idx - b.idx);
 case 'name-desc': return collator.compare(b.name, a.name) || (a.idx - b.idx);
 default: return a.idx - b.idx; // Standard
 }
 });

 const frag = document.createDocumentFragment();
 decorated.forEach(d => frag.appendChild(d.el));
 root.appendChild(frag);
 }

 // --- Toggle på knappen ---
 SORT_TOGGLE.addEventListener('click', (e) => {
 e.stopPropagation();
 if (!isOpen) openMenu(); else closeMenu();
 });

 // Init – ved full side-refresh skal vi alltid starte på "Standard sortering"
 const initial = 'default';
 try { localStorage.setItem(LS_KEY, initial); } catch(e) {}
 setActive(initial);
 applySort(initial);

 // Re-apply sort når produktlista oppdateres via BDPF/AJAX
 document.addEventListener('bdpf:products-updated', () => {
 applySort(localStorage.getItem(LS_KEY) || 'default');
 });

 // Eksponer helper (frivillig)
 window.BD_SORT = {
 apply: (mode) => { setActive(mode); localStorage.setItem(LS_KEY, mode); applySort(mode); },
 open: openMenu,
 close: closeMenu
 };
})();
</script>
